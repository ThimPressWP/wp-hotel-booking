!function(t){TPHB_Extra_Site={init:function(){this.toggle_extra(),this.removePackage()},parseJSON:function(a){if(!t.isPlainObject(a)){var e=a.match(/<!-- HB_AJAX_START -->(.*)<!-- HB_AJAX_END -->/);try{a=e?t.parseJSON(e[1]):t.parseJSON(a)}catch(t){console.log(t),a={}}}return a},toggle_extra:function(){t(document).on("change",".number_room_select",function(a){a.preventDefault();var e=t(this),i=e.parents(".hb-search-room-results"),n=i.find(".hb_addition_package_extra"),o=n.find(".hb_addition_packages"),r=e.val();""!==r?(i.parent().siblings().find(".hb_addition_packages").removeClass("active").slideUp(),o.removeAttr("style").addClass("active"),n.removeAttr("style").slideDown()):(n.slideUp(),r=1),i.find(".hb_optional_quantity").val(r)}),t(document).on("click",".hb_package_toggle",function(a){a.preventDefault();var e=t(this),i=e.parents(".hb_addition_package_extra");toggle=i.find(".hb_addition_packages"),e.toggleClass("active"),toggle.toggleClass("active"),TPHB_Extra_Site.optional_toggle(toggle)})},optional_toggle:function(t){t.hasClass("active")?t.slideDown():t.slideUp()},toggleCheckbox:function(){t(document).on("change",".hb_optional_quantity_selected",function(a){a.preventDefault();var e=t(this),i=e.parents("li:first").find(".hb_optional_quantity");e.is(":checked")?i.attr("readonly",!0):i.hasClass("tp_hb_readonly")||i.removeAttr("readonly")})},removePackage:function(){t(document).on("click",".hb_package_remove",function(a){a.preventDefault();var e=t(this),i=e.attr("data-cart-id"),n=e.parents(".hb_mini_cart_item:first"),o=e.parents(".hb_mini_cart_item:first, tr");void 0!==n&&0!==n.length||(n=e.parents(".hb_checkout_item.package:first")),t.ajax({url:hotel_settings.ajax,method:"POST",data:{action:"tp_hotel_booking_remove_package",cart_id:i},dataType:"html",beforeSend:function(){o.hb_overlay_ajax_start()}}).done(function(a){void 0!==(a=TPHB_Extra_Site.parseJSON(a)).status&&"success"===a.status&&(HB_Booking_Cart.hb_add_to_cart_callback(a,function(){for(var e=t("#hotel-booking-payment, #hotel-booking-cart"),i=0;i<e.length;i++){for(var n=t(e[i]),o=n.find("table").find(".hb_checkout_item.package"),r=0;r<o.length;r++){var _=t(o[r]),c=_.attr("data-cart-id"),d=_.attr("data-parent-id");if(c===a.package_id&&d===a.cart_id){t('tr.hb_checkout_item.package[data-cart-id="'+c+'"][data-parent-id="'+d+'"]');var s=t('tr.hb_addition_services_title[data-cart-id="'+d+'"]'),l=t('.hb_checkout_item:not(.package)[data-cart-id="'+d+'"]');if(1===t('tr.hb_checkout_item.package[data-parent-id="'+d+'"]').length)_.remove(),s.remove(),l.find("td:first").removeAttr("rowspan");else{var h=l.find("td:first").attr("rowspan");_.remove(),l.find("td:first").attr("rowspan",h-1)}break}}void 0!==a.sub_total&&n.find("span.hb_sub_total_value").html(a.sub_total),void 0!==a.grand_total&&n.find("span.hb_grand_total_value").html(a.grand_total),void 0!==a.advance_payment&&n.find("span.hb_advance_payment_value").html(a.advance_payment)}}),t("body").trigger("hb_remove_extra_to_cart")),o.hb_overlay_ajax_stop()})})}},t(document).ready(function(){TPHB_Extra_Site.init()})}(jQuery);